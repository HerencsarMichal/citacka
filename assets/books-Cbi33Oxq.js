import{s as n}from"./index-BLClEv55.js";const c=n("books",{state:()=>({allBooks:[],cart:[],purchasedBooks:[],isLoading:!1}),getters:{cartItemsCount(o){return o.cart.reduce((t,e)=>t+e.quantity,0)},cartTotal(o){return o.cart.reduce((t,e)=>{const s=o.allBooks.find(a=>a.id===e.bookId);return t+(s?s.price*e.quantity:0)},0)},availableBooks(o){return o.allBooks.filter(t=>t.stock>0)},libraryBooks(o){return o.purchasedBooks.map(t=>({...o.allBooks.find(s=>s.id===t.bookId),...t}))},isInCart:o=>t=>o.cart.some(e=>e.bookId===t),isPurchased:o=>t=>o.purchasedBooks.some(e=>e.bookId===t)},actions:{async initializeBooks(){this.isLoading=!0;const o=this.generateBookMetadata();this.allBooks=o.map(t=>({...t,stock:Math.floor(Math.random()*20)+5,price:Math.floor(Math.random()*20)+10,rating:(Math.random()*2+3).toFixed(1)})),this.isLoading=!1},generateBookMetadata(){const o=["J.K. Rowling","J.R.R. Tolkien","George Orwell","Paulo Coelho","Antoine de Saint-ExupÃ©ry","F. Scott Fitzgerald","Jane Austen","Ernest Hemingway","Gabriel GarcÃ­a MÃ¡rquez","Harper Lee"],t=["Fantasy","Sci-Fi","Klasika","Romantika","Thriller","DobrodruÅ¾stvo"],e=["ğŸ“š","ğŸ“–","ğŸ“•","ğŸ“—","ğŸ“˜","ğŸ“™","âš¡","ğŸ’","ğŸ‘ï¸","ğŸ§ª","ğŸ‘‘","ğŸŒŸ"],s=["#FFD700","#8B4513","#2C3E50","#E67E22","#3498DB","#9B59B6","#E74C3C","#27AE60"],a=[];for(let r=1;r<=100;r++)a.push({id:r,filename:`Book${r}.txt`,title:`Kniha ${r}`,author:o[Math.floor(Math.random()*o.length)],genre:t[Math.floor(Math.random()*t.length)],emoji:e[Math.floor(Math.random()*e.length)],color:s[Math.floor(Math.random()*s.length)],description:"FascinujÃºci prÃ­beh, ktorÃ½ vÃ¡s pohltÃ­ od prvej do poslednej strany. TÃ¡to kniha sa stala bestsellerom a zÃ­skala mnoÅ¾stvo ocenenÃ­.",pages:Math.floor(Math.random()*400)+100});return a},addToCart(o,t=1){const e=this.allBooks.find(a=>a.id===o);if(!e)return{success:!1,message:"Kniha nebola nÃ¡jdenÃ¡"};if(e.stock<t)return{success:!1,message:"Nedostatok kusov na sklade"};const s=this.cart.find(a=>a.bookId===o);if(s){if(e.stock<s.quantity+t)return{success:!1,message:"Nedostatok kusov na sklade"};s.quantity+=t}else this.cart.push({bookId:o,quantity:t,addedAt:new Date().toISOString()});return{success:!0,message:"PridanÃ© do koÅ¡Ã­ka"}},removeFromCart(o){const t=this.cart.findIndex(e=>e.bookId===o);t!==-1&&this.cart.splice(t,1)},updateCartQuantity(o,t){const e=this.cart.find(a=>a.bookId===o),s=this.allBooks.find(a=>a.id===o);return!e||!s?{success:!1}:t<=0?(this.removeFromCart(o),{success:!0}):t>s.stock?{success:!1,message:"Nedostatok kusov na sklade"}:(e.quantity=t,{success:!0})},clearCart(){this.cart=[]},async checkout(){if(this.cart.length===0)return{success:!1,message:"KoÅ¡Ã­k je prÃ¡zdny"};for(const t of this.cart){const e=this.allBooks.find(s=>s.id===t.bookId);if(!e||e.stock<t.quantity)return{success:!1,message:`Nedostatok kusov: ${e?.title||"neznÃ¡ma kniha"}`}}for(const t of this.cart){const e=this.allBooks.find(s=>s.id===t.bookId);e.stock-=t.quantity;for(let s=0;s<t.quantity;s++)this.purchasedBooks.push({bookId:t.bookId,purchasedAt:new Date().toISOString(),status:"planned",progress:0})}const o={items:[...this.cart],total:this.cartTotal,date:new Date().toISOString()};return this.clearCart(),{success:!0,message:"ObjednÃ¡vka ÃºspeÅ¡ne dokonÄenÃ¡",order:o}},updateReadingProgress(o,t){const e=this.purchasedBooks.find(s=>s.bookId===o);e&&(e.progress=t,t===100?e.status="completed":t>0&&(e.status="reading"))},async loadBookContent(o){try{const t=this.allBooks.find(a=>a.id===o);if(!t)return null;const s=await(await fetch(`/src/books/${t.filename}`)).text();return{...t,content:s}}catch(t){return console.error("Chyba pri naÄÃ­tanÃ­ knihy:",t),null}}}});export{c as u};
