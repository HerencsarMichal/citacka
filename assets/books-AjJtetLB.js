import{s as i}from"./index-CkItGXuV.js";const l=i("books",{state:()=>({allBooks:[],cart:[],purchasedBooks:[],isLoading:!1}),getters:{cartItemsCount(t){return t.cart.reduce((o,e)=>o+e.quantity,0)},cartTotal(t){return t.cart.reduce((o,e)=>{const s=t.allBooks.find(a=>a.id===e.bookId);return o+(s?s.price*e.quantity:0)},0)},availableBooks(t){return t.allBooks.filter(o=>o.stock>0)},libraryBooks(t){return t.purchasedBooks.map(o=>({...t.allBooks.find(s=>s.id===o.bookId),...o}))},isInCart:t=>o=>t.cart.some(e=>e.bookId===o),isPurchased:t=>o=>t.purchasedBooks.some(e=>e.bookId===o)},actions:{async initializeBooks(){this.isLoading=!0;const t=this.generateBookMetadata();this.allBooks=t.map(o=>({...o,stock:Math.floor(Math.random()*20)+5,price:Math.floor(Math.random()*20)+10,rating:(Math.random()*2+3).toFixed(1)})),this.isLoading=!1},generateBookMetadata(){const t=["J.K. Rowling","J.R.R. Tolkien","George Orwell","Paulo Coelho","Antoine de Saint-ExupÃ©ry","F. Scott Fitzgerald","Jane Austen","Ernest Hemingway","Gabriel GarcÃ­a MÃ¡rquez","Harper Lee"],o=["Fantasy","Sci-Fi","Klasika","Romantika","Thriller","DobrodruÅ¾stvo"],e=["ğŸ“š","ğŸ“–","ğŸ“•","ğŸ“—","ğŸ“˜","ğŸ“™","âš¡","ğŸ’","ğŸ‘ï¸","ğŸ§ª","ğŸ‘‘","ğŸŒŸ"],s=["#FFD700","#8B4513","#2C3E50","#E67E22","#3498DB","#9B59B6","#E74C3C","#27AE60"],a=[];for(let n=1;n<=100;n++)a.push({id:n,filename:`Book${n}.txt`,title:`Kniha ${n}`,author:t[Math.floor(Math.random()*t.length)],genre:o[Math.floor(Math.random()*o.length)],emoji:e[Math.floor(Math.random()*e.length)],color:s[Math.floor(Math.random()*s.length)],description:"FascinujÃºci prÃ­beh, ktorÃ½ vÃ¡s pohltÃ­ od prvej do poslednej strany. TÃ¡to kniha sa stala bestsellerom a zÃ­skala mnoÅ¾stvo ocenenÃ­.",pages:Math.floor(Math.random()*400)+100});return a},addToCart(t,o=1){const e=this.allBooks.find(a=>a.id===t);if(!e)return{success:!1,message:"Kniha nebola nÃ¡jdenÃ¡"};if(e.stock<o)return{success:!1,message:"Nedostatok kusov na sklade"};const s=this.cart.find(a=>a.bookId===t);if(s){if(e.stock<s.quantity+o)return{success:!1,message:"Nedostatok kusov na sklade"};s.quantity+=o}else this.cart.push({bookId:t,quantity:o,addedAt:new Date().toISOString()});return{success:!0,message:"PridanÃ© do koÅ¡Ã­ka"}},removeFromCart(t){const o=this.cart.findIndex(e=>e.bookId===t);o!==-1&&this.cart.splice(o,1)},updateCartQuantity(t,o){const e=this.cart.find(a=>a.bookId===t),s=this.allBooks.find(a=>a.id===t);return!e||!s?{success:!1}:o<=0?(this.removeFromCart(t),{success:!0}):o>s.stock?{success:!1,message:"Nedostatok kusov na sklade"}:(e.quantity=o,{success:!0})},clearCart(){this.cart=[]},async checkout(){if(this.cart.length===0)return{success:!1,message:"KoÅ¡Ã­k je prÃ¡zdny"};for(const o of this.cart){const e=this.allBooks.find(s=>s.id===o.bookId);if(!e||e.stock<o.quantity)return{success:!1,message:`Nedostatok kusov: ${e?.title||"neznÃ¡ma kniha"}`}}for(const o of this.cart){const e=this.allBooks.find(s=>s.id===o.bookId);e.stock-=o.quantity;for(let s=0;s<o.quantity;s++)this.purchasedBooks.push({bookId:o.bookId,purchasedAt:new Date().toISOString(),status:"planned",progress:0})}const t={items:[...this.cart],total:this.cartTotal,date:new Date().toISOString()};return this.clearCart(),{success:!0,message:"ObjednÃ¡vka ÃºspeÅ¡ne dokonÄenÃ¡",order:t}},updateReadingProgress(t,o){const e=this.purchasedBooks.find(s=>s.bookId===t);e&&(e.progress=o,o===100?e.status="completed":o>0&&(e.status="reading"))},async loadBookContent(t){try{const o=this.allBooks.find(n=>n.id===t);if(!o)return null;const e=[`/books/${o.filename}`,`/citacka/books/${o.filename}`,`./books/${o.filename}`];let s=null,a=null;for(const n of e)try{console.log(`ğŸ” SkÃºÅ¡am naÄÃ­taÅ¥: ${n}`);const r=await fetch(n);if(r.ok){s=await r.text(),a=n,console.log(`âœ… Ãšspech! Kniha naÄÃ­tanÃ¡ z: ${n}`);break}}catch(r){console.log(`âŒ Cesta ${n} zlyhala:`,r.message);continue}return s?{...o,content:s}:(console.warn(`âš ï¸ Kniha ${o.filename} sa nenaÅ¡la na Å¾iadnej ceste, pouÅ¾ije sa placeholder`),{...o,content:null})}catch(o){return console.error("Chyba pri naÄÃ­tanÃ­ knihy:",o),null}}}});export{l as u};
